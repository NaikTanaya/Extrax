$(document).ready(function() {
    var limit = 50;          // Number of records to fetch per request
    var offset = 0;          // Offset to fetch data from
    var hasMoreEntries = true; // Flag to check if more entries are available

    // Initialize DataTable with client-side processing enabled
    var t = $('#example').DataTable({
        paging: true,         // Enable pagination
        pageLength: limit,    // Show 50 records per page
        serverSide: false,    // Client-side pagination
        processing: true,     // Show processing indicator
        data: [],             // Start with empty data
        columns: [
            { data: 'EXECUTION_ID' },          // Data column 1
            { data: 'TECHNICAL_API_NAME' },    // Data column 2
            { data: 'MAJOR_VERSION' },         // Data column 3
            { data: 'APE_API_ID' },            // Data column 4
            { data: 'DEMAND_TYPE' }            // Data column 5
        ]
    });

    // Function to load data from the server
    function loadData() {
        if (!hasMoreEntries) return; // Exit if no more records are available

        $.ajax({
            url: '/yourAPIEndpoint', // Your API endpoint for fetching data
            type: 'GET',
            data: {
                limit: limit,  // Number of records to fetch
                offset: offset // Starting position for fetching
            },
            success: function(response) {
                hasMoreEntries = response.hasMoreEntries; // Check if more data is available

                // Add the new rows to the DataTable without clearing previous rows
                response.data.forEach(function(item) {
                    t.row.add(item);
                });

                // Draw the table with the new data
                t.draw(false);

                // Increase the offset for the next batch
                offset += limit;
            },
            error: function() {
                alert('Error fetching data');
            }
        });
    }

    // Load the initial batch of 50 records
    loadData();

    // Detect when user reaches the last page and fetch the next set of records
    $('#example').on('page.dt', function() {
        var info = t.page.info();

        // If the user is on the last page and there are more records to fetch
        if (info.page === info.pages - 1 && hasMoreEntries) {
            loadData(); // Fetch and append the next batch of records
        }
    });
});
